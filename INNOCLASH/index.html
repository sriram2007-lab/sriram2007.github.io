<!DOCTYPE html>
<html>
<head>
    <title>Family Energy & Carbon Calculator Wizard</title>
    <link rel="stylesheet" href="style.css">

    <style>
        body {
            background-image: url("image.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }

        #startBox {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
    </style>
</head>

<body>

<h1>Family Energy & Carbon Calculator</h1>

<!-- START -->
<div class="box" id="startBox">
    <p>Small acts, when multiplied by millions of people, can transform the world.</p>
    <button onclick="showSection('electricityBox')">Start Calculation</button>
</div>

<!-- ELECTRICITY -->
<div class="box" id="electricityBox">
    <h2>Electricity Usage</h2>

    <label>Number of Family Members</label>
    <input type="number" id="members">

    <label>Number of Fans</label>
    <input type="number" id="fans">

    <label>LED Lights</label>
    <input type="number" id="led">

    <label>Non-LED Lights</label>
    <input type="number" id="nonled">

    <label>Refrigerator Runtime (hrs/day)</label>
    <input type="number" id="fridge">

    <label>AC Runtime (hrs/day)</label>
    <input type="number" id="ac">

    <label>TV Runtime (hrs/day)</label>
    <input type="number" id="tv">

    <label>Washing Machine Usage (hrs/day)</label>
    <input type="number" id="wm">

    <label>Heater Usage (hrs/day)</label>
    <input type="number" id="heater">

    <label>EV Charging Electricity (kWh/day)</label>
    <input type="number" id="evPower">

    <p class="disclaimer">*Approximate calculation; may vary per household.*</p>

    <button onclick="showSection('startBox')">Back</button>
    <button onclick="calculateElectricity(); showSection('fuelBox')">Next</button>
</div>

<!-- FUEL -->
<div class="box" id="fuelBox">
    <h2>Fuel Consumption</h2>

    <label>Select Vehicle Type</label>
    <select id="vehicleType" onchange="toggleFuelOptions()">
        <option value="">-- Select --</option>
        <option value="bike">Bike</option>
        <option value="car">Car</option>
        <option value="both">Bike + Car</option>
    </select>

    <div id="bikeBox" style="display:none;">
        <label>Number of Bikes</label>
        <input type="number" id="numBikes">
        <div id="bikeInputs"></div>
        <button onclick="addBikeInputs()">Add Bike Details</button>
    </div>

    <div id="carBox" style="display:none;">
        <label>Number of Cars</label>
        <input type="number" id="numCars">
        <div id="carInputs"></div>
        <button onclick="addCarInputs()">Add Car Details</button>
    </div>

    <p class="disclaimer">*Approximate calculation; may vary per vehicle.*</p>

    <button onclick="showSection('electricityBox')">Back</button>
    <button onclick="calculateFuel(); showSection('waterBox')">Next</button>
</div>

<!-- WATER -->

<div class="box" id="waterBox">
    <h2>Water Usage</h2>

    <label>Number of Family Members</label>
    <input type="number" id="waterMembers" placeholder="e.g. 4">

    <label>Source of Water</label>
    <select id="waterSource">
        <option value="">-- Select --</option>
        <option value="municipal">Municipal</option>
        <option value="borewell">Borewell</option>
        <option value="private">Private Tanker</option>
    </select>

    <label>Water Consumed (liters/day)</label>
    <input type="number" id="waterUsed" placeholder="e.g. 500">

    <p class="disclaimer">
        Municipal: 135 LPCD | Borewell: 170 LPCD | Private: 80 LPCD
    </p>

    <button onclick="showSection('fuelBox')">Back</button>
    <button onclick="finishCalculation()">Finish</button>
</div>


<!-- RESULT -->
<div class="box" id="finishBox">
    <h2>Results & Carbon Footprint</h2>
    <div id="summary" class="result"></div>
    <canvas id="circleScore" width="200" height="220"></canvas>
</div>

<script>
function showSection(id){
    document.querySelectorAll('.box').forEach(b => b.style.display='none');
    document.getElementById(id).style.display='block';
}

function toggleFuelOptions() {
    let type = vehicleType.value;
    bikeBox.style.display = (type==="bike"||type==="both")?"block":"none";
    carBox.style.display = (type==="car"||type==="both")?"block":"none";
}

let electricityKwhTotal=0, totalFuelLitres=0, waterUsedLitres=0, members=1;

function calculateElectricity() {
    members = Number(membersInput = members?.value || document.getElementById("members").value || 1);

    electricityKwhTotal =
        fans.value*70*12/1000 +
        led.value*12*6/1000 +
        nonled.value*60*6/1000 +
        fridge.value*200/1000 +
        ac.value*1500/1000 +
        tv.value*100/1000 +
        wm.value*500/1000 +
        heater.value*3000/1000 +
        evPower.value*5000/1000;
}

function addBikeInputs() {
    bikeInputs.innerHTML="";
    for(let i=1;i<=numBikes.value;i++){
        bikeInputs.innerHTML+=`
        <label>Bike ${i} KM/day</label><input class="bikeKm">
        <label>Mileage</label><input class="bikeMileage">`;
    }
}

function addCarInputs() {
    carInputs.innerHTML="";
    for(let i=1;i<=numCars.value;i++){
        carInputs.innerHTML+=`
        <label>Car ${i} KM/day</label><input class="carKm">
        <label>Mileage</label><input class="carMileage">`;
    }
}

function calculateFuel(){
    totalFuelLitres=0;
    document.querySelectorAll(".bikeKm").forEach((k,i)=>{
        totalFuelLitres+=k.value/(document.querySelectorAll(".bikeMileage")[i].value||1);
    });
    document.querySelectorAll(".carKm").forEach((k,i)=>{
        totalFuelLitres+=k.value/(document.querySelectorAll(".carMileage")[i].value||1);
    });
}

function finishCalculation(){
    waterUsedLitres = Number(waterUsed.value||0);

    let fuelCO2 = totalFuelLitres * 2.31;
    let eleCO2 = electricityKwhTotal * 0.85;
    let waterCO2 = waterUsedLitres * 0.0003;

    let totalCO2 = fuelCO2 + eleCO2 + waterCO2;
    let perPersonCO2 = totalCO2 / members;
    let score = Math.max(0, 100 - totalCO2 * 3);

    summary.innerHTML = `
    <b>Daily:</b> Electricity ${electricityKwhTotal.toFixed(2)} kWh | Fuel ${totalFuelLitres.toFixed(2)} L | Water ${waterUsedLitres} L<br>
    <b>Monthly:</b> Electricity ${(electricityKwhTotal*30).toFixed(2)} kWh | Fuel ${(totalFuelLitres*30).toFixed(2)} L | Water ${(waterUsedLitres*30)} L<br>
    <b>COâ‚‚:</b> ${totalCO2.toFixed(2)} kg/day | Per Person ${perPersonCO2.toFixed(2)} kg/day
    `;

    showSection("finishBox");
    drawCircleScore(score);
}

function drawCircleScore(percent){
    let c = circleScore.getContext("2d");
    c.clearRect(0,0,200,220);

    c.beginPath();
    c.arc(100,100,80,0,2*Math.PI);
    c.strokeStyle="#ddd"; c.lineWidth=15; c.stroke();

    c.beginPath();
    c.arc(100,100,80,-Math.PI/2,(percent/100)*2*Math.PI-Math.PI/2);
    c.strokeStyle=percent>66?"#0f9d58":percent>33?"#f4b400":"#db4437";
    c.lineWidth=15; c.stroke();

    c.fillStyle="#000";
    c.font="24px Times New Roman";
    c.textAlign="center";
    c.fillText(Math.round(percent)+"%",100,100);

    c.font="16px Times New Roman";
    c.fillText("Sustainability Score",100,220);
}
</script>

</body>
</html>
